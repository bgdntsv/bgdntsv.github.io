{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\art23\\\\Desktop\\\\react\\\\first\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\art23\\\\Desktop\\\\react\\\\first\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:\\\\Users\\\\art23\\\\Desktop\\\\react\\\\first\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\art23\\\\Desktop\\\\react\\\\first\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{userAPI}from'../api/api';import{updateObjectInArray}from'../objectsHelper';var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_USERS_TOTAL_COUNT='SET_USERS_TOTAL_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLlOWING_IN_PROGRESS='TOGGLE_IS_FOLlOWING_IN_PROGRESS';var initialState={users:[],pageSize:5,totalUsersCount:0,currentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,'id',{followed:true})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,'id',{followed:false})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:action.users});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_USERS_TOTAL_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.totalCount});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FOLlOWING_IN_PROGRESS:return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!==action.userId;})});default:return initialState;}};export default usersReducer;export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setUsersTotalCount=function setUsersTotalCount(totalCount){return{type:SET_USERS_TOTAL_COUNT,totalCount:totalCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleIsFollowingInProgress=function toggleIsFollowingInProgress(isFetching,userId){return{type:TOGGLE_IS_FOLlOWING_IN_PROGRESS,isFetching:isFetching,userId:userId};};export var requestUsers=function requestUsers(page,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));_context.next=3;return userAPI.getUsers(page,pageSize);case 3:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setCurrentPage(page));dispatch(setUsers(data.items));dispatch(setUsersTotalCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};var followUnfollow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch,userId,methodApi,actionCreator){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleIsFollowingInProgress(true,userId));_context2.next=3;return methodApi(userId);case 3:response=_context2.sent;if(response.data.resultCode===0){dispatch(actionCreator(userId));}dispatch(toggleIsFollowingInProgress(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function followUnfollow(_x2,_x3,_x4,_x5){return _ref2.apply(this,arguments);};}();export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:followUnfollow(dispatch,userId,userAPI.follow.bind(userId),followSuccess);case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x6){return _ref3.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return function(dispatch){followUnfollow(dispatch,userId,userAPI.unFollow.bind(userId),unfollowSuccess);};};","map":{"version":3,"sources":["C:/Users/art23/Desktop/react/first/src/redux/usersReducer.js"],"names":["userAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_USERS_TOTAL_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLlOWING_IN_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","userId","followed","totalCount","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setUsersTotalCount","toggleIsFetching","toggleIsFollowingInProgress","requestUsers","page","dispatch","getUsers","data","items","followUnfollow","methodApi","actionCreator","response","resultCode","follow","bind","unfollow","unFollow"],"mappings":"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","sourcesContent":["import {userAPI} from '../api/api'\r\nimport {updateObjectInArray} from '../objectsHelper'\r\n\r\nconst FOLLOW = 'FOLLOW'\r\nconst UNFOLLOW = 'UNFOLLOW'\r\nlet SET_USERS = 'SET_USERS'\r\nlet SET_CURRENT_PAGE = 'SET_CURRENT_PAGE'\r\nlet SET_USERS_TOTAL_COUNT = 'SET_USERS_TOTAL_COUNT'\r\nlet TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING'\r\nlet TOGGLE_IS_FOLlOWING_IN_PROGRESS = 'TOGGLE_IS_FOLlOWING_IN_PROGRESS'\r\n\r\nlet initialState = {\r\n    users: [],\r\n    pageSize: 5,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    isFetching: false,\r\n    followingInProgress: []\r\n}\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, action.userId, 'id', {followed: true})\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, action.userId, 'id', {followed: false})\r\n            }\r\n        case SET_USERS:\r\n            return {...state, users: action.users}\r\n        case SET_CURRENT_PAGE:\r\n            return {...state, currentPage: action.currentPage}\r\n        case SET_USERS_TOTAL_COUNT:\r\n            return {...state, totalUsersCount: action.totalCount}\r\n        case TOGGLE_IS_FETCHING:\r\n            return {...state, isFetching: action.isFetching}\r\n        case TOGGLE_IS_FOLlOWING_IN_PROGRESS:\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching\r\n                    ? [...state.followingInProgress, action.userId]\r\n                    : state.followingInProgress.filter(id => id !== action.userId)\r\n            }\r\n        default:\r\n            return initialState\r\n    }\r\n}\r\nexport default usersReducer\r\nexport const followSuccess = (userId) => ({type: FOLLOW, userId})\r\nexport const unfollowSuccess = (userId) => ({type: UNFOLLOW, userId})\r\nexport const setUsers = (users) => ({type: SET_USERS, users})\r\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\r\nexport const setUsersTotalCount = (totalCount) => ({type: SET_USERS_TOTAL_COUNT, totalCount})\r\nexport const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\r\nexport const toggleIsFollowingInProgress = (isFetching, userId) => ({\r\n    type: TOGGLE_IS_FOLlOWING_IN_PROGRESS,\r\n    isFetching,\r\n    userId\r\n})\r\n\r\nexport const requestUsers = (page, pageSize) => async (dispatch) => {\r\n    dispatch(toggleIsFetching(true))\r\n    let data = await userAPI.getUsers(page, pageSize)\r\n    dispatch(toggleIsFetching(false))\r\n    dispatch(setCurrentPage(page))\r\n    dispatch(setUsers(data.items))\r\n    dispatch(setUsersTotalCount(data.totalCount))\r\n\r\n}\r\nlet followUnfollow = async (dispatch, userId, methodApi, actionCreator) => {\r\n    dispatch(toggleIsFollowingInProgress(true, userId))\r\n    let response = await methodApi(userId)\r\n    if (response.data.resultCode === 0) {\r\n        dispatch(actionCreator(userId))\r\n    }\r\n    dispatch(toggleIsFollowingInProgress(false, userId))\r\n}\r\nexport const follow = (userId) => async (dispatch) => {\r\n    followUnfollow(dispatch, userId, userAPI.follow.bind(userId), followSuccess)\r\n}\r\nexport const unfollow = (userId) => (dispatch) => {\r\n    followUnfollow(dispatch, userId, userAPI.unFollow.bind(userId), unfollowSuccess)\r\n}\r\n"]},"metadata":{},"sourceType":"module"}