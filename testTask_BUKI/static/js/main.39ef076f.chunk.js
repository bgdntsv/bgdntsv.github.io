(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{10:function(e,s,t){e.exports={messages:"messages_messages__5_pkl",messagesList:"messages_messagesList__2u3Sk",messagesListItems:"messages_messagesListItems__p4ZiT"}},19:function(e,s,t){e.exports={inputBlock:"input_inputBlock__3-jie"}},21:function(e,s,t){e.exports={chat:"chat_chat__3egHL"}},29:function(e,s,t){},3:function(e,s,t){e.exports={ava:"message_ava__1YtEl",message:"message_message__Bq9YA",owner:"message_owner__kqfVC",delete:"message_delete__1I7Vp",edit:"message_edit__Fkg_C",like:"message_like__2dOr3",textBlock:"message_textBlock__2_b57",messageText:"message_messageText__37Q9p",date:"message_date__1GwnM",name:"message_name__1ICLS"}},30:function(e,s,t){},37:function(e,s,t){"use strict";t.r(s);var a=t(0),n=t(6),c=t.n(n),r=(t(29),t(17)),i=t(18),o=t(24),u=t(23),g=(t(30),t(9)),l=t.n(g),d=t(1),m=function(e){var s=e.countMessages,t=e.countUsers,a=e.lastData;return Object(d.jsxs)("header",{className:l.a.header,children:[Object(d.jsxs)("p",{className:l.a.logo,children:["My Chat ",Object(d.jsxs)("span",{children:[t," users ",s," messages"]})]}),Object(d.jsxs)("p",{className:l.a.lastData,children:["Last message: ",a]})]})},j=Object(a.memo)(m),b=t(4),h=t(3),O=t.n(h),p=t.p+"static/media/heart.d16a1603.svg",f=t.p+"static/media/heartFill.d908e8ce.svg",_=function(e){var s=e.ava,t=e.date,n=e.name,c=e.messageText,r=e.deleteMessage,i=e.id,o=e.editMessage,u=Object(a.useState)(!1),g=Object(b.a)(u,2),l=g[0],m=g[1],j=Object(a.useState)(!1),h=Object(b.a)(j,2),_=h[0],x=h[1],v=Object(a.useRef)(null),M=function(){return x(!_)};return Object(d.jsxs)("div",{className:"".concat(O.a.message," ").concat("Taylor"===n?O.a.owner:""),children:[Object(d.jsx)("img",{className:O.a.ava,src:s,alt:""}),Object(d.jsxs)("div",{className:O.a.textBlock,children:[Object(d.jsx)("p",{className:O.a.name,children:n}),_?Object(d.jsx)("input",{ref:v,defaultValue:c}):Object(d.jsx)("p",{className:O.a.messageText,children:c})]}),Object(d.jsx)("p",{className:O.a.date,children:t}),Object(d.jsx)("button",{className:O.a.like,onClick:function(){m(!l)},children:Object(d.jsx)("img",{src:l?f:p,alt:"&heart;"})}),Object(d.jsx)("button",{className:O.a.delete,onClick:function(){return r(i)},children:"\xd7"}),_?Object(d.jsx)("button",{className:O.a.edit,onClick:function(){var e=v.current.value;""===e?r(i):o(i,e),M()},children:"\u2192"}):Object(d.jsx)("button",{className:O.a.edit,onClick:M,children:"/"})]})},x=Object(a.memo)(_),v=t(10),M=t.n(v),C=t(19),k=t.n(C),S=function(e){var s=e.lastId,t=e.addMessage,n=Object(a.useState)(""),c=Object(b.a)(n,2),r=c[0],i=c[1];return Object(d.jsxs)("div",{className:k.a.inputBlock,children:[Object(d.jsx)("input",{value:r,onChange:function(e){return i(e.target.value)},placeholder:"Type something...",type:"text"}),Object(d.jsx)("button",{disabled:""===r,onClick:function(){var e=Date.now();e=new Date(e);var a="".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds());t({avatar:"https://i.pravatar.cc/300?img=12",created_at:a,id:s,message:r,user:"Taylor"}),i("")},children:"SEND"})]})},D=Object(a.memo)(S),N=t.p+"static/media/loader.3602fbbd.svg",y=function(e){var s=e.messages,t=e.addMessage,n=e.isFetching,c=e.deleteMessage,r=e.editMessage,i=Object(a.useRef)(null),o=s.map((function(e){return Object(d.jsx)(x,{id:e.id,editMessage:r,deleteMessage:c,ava:e.avatar,name:e.user,date:e.created_at,messageText:e.message},e.id)})),u=Object(a.useState)(null),g=Object(b.a)(u,2),l=g[0],m=g[1],j=Object(a.useState)(0),h=Object(b.a)(j,2),O=h[0],p=h[1];return Object(a.useEffect)((function(){s.length>0&&(m(parseInt(s[s.length-1].id)+1),p(s.length))}),[s]),Object(a.useEffect)((function(){return function(){var e=i.current;e.scrollTop=e.scrollHeight.toString()}()}),[O]),Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:M.a.messages,children:[Object(d.jsx)("div",{ref:i,className:M.a.messagesList,children:n?Object(d.jsx)("img",{src:N,alt:""}):Object(d.jsx)("div",{className:M.a.messagesListItems,children:o})}),Object(d.jsx)(D,{addMessage:t,lastId:l})]})})},E=Object(a.memo)(y),T=t(8),L=t(16),w=t.n(L),I=t(20),F=t(11),G=t(2),B="GET_MESSAGES",A="USERS_IS_GETTING",U="ADD_MESSAGE",H="DELETE_MESSAGE",J="EDIT_MESSAGE",R={messages:[],isLoading:!1,usersCount:0,messagesCount:0,lastData:0},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,s=arguments.length>1?arguments[1]:void 0;switch(s.type){case B:return Object(G.a)(Object(G.a)({},e),{},{messages:s.messages,messagesCount:s.messages.length,usersCount:s.countUsers,lastData:s.lastData});case A:return Object(G.a)(Object(G.a)({},e),{},{isLoading:s.fetching});case U:var t=[].concat(Object(F.a)(e.messages),[s.newMessage]);return Object(G.a)(Object(G.a)({},e),{},{messages:t,messagesCount:e.messages.length+1,lastData:t[t.length-1].created_at});case J:var a=e.messages.map((function(e){return e.id===s.id?Object(G.a)(Object(G.a)({},e),{},{message:s.message}):Object(G.a)({},e)}));return Object(G.a)(Object(G.a)({},e),{},{messages:a});case H:var n=e.messages.filter((function(e){return e.id!==s.id}));return Object(G.a)(Object(G.a)({},e),{},{messages:Object(F.a)(n),messagesCount:e.messages.length-1,lastData:n[n.length-1].created_at});default:return e}},Y=function(e,s,t){return{type:B,messages:e,countUsers:s,lastData:t}},q=function(e){return{type:A,fetching:e}},P=t(21),X=t.n(P),Q=function(e){Object(o.a)(t,e);var s=Object(u.a)(t);function t(){return Object(r.a)(this,t),s.apply(this,arguments)}return Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.getMessages()}},{key:"render",value:function(){return Object(d.jsxs)("div",{className:X.a.chat,children:[Object(d.jsx)(j,{lastData:this.props.lastMessage,countMessages:this.props.messagesCount,countUsers:this.props.usersCount}),Object(d.jsx)(E,{editMessage:this.props.editMessage,deleteMessage:this.props.deleteMessage,addMessage:this.props.addMessage,isFetching:this.props.isGettingMessages,messages:this.props.messages}),Object(d.jsxs)("footer",{children:[Object(d.jsxs)("ul",{children:[Object(d.jsx)("li",{children:"Home"}),Object(d.jsx)("li",{children:"About"}),Object(d.jsx)("li",{children:"Contact us"})]}),Object(d.jsx)("p",{children:"@ Copyright 2019"})]})]})}}]),t}(a.Component),Z=Object(T.b)((function(e){return{messages:e.messages.messages,isGettingMessages:e.messages.isLoading,messagesCount:e.messages.messagesCount,usersCount:e.messages.usersCount,lastMessage:e.messages.lastData}}),{editMessage:function(e,s){return function(t){t(function(e,s){return{type:J,id:e,message:s}}(e,s))}},getMessages:function(){return function(){var e=Object(I.a)(w.a.mark((function e(s){var t,a,n,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(q(!0)),e.next=3,fetch("https://run.mocky.io/v3/b13799bf-0bf4-4a74-bf46-b7a2fb35a8c8");case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=Object(F.a)(new Set(a.map((function(e){return e.user})))).length,c=a.sort((function(e,s){return e.created_at-s.created_at}))[a.length-1].created_at,s(Y(a,n,c)),s(q(!1));case 11:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}()},addMessage:function(e){return function(s){s(function(e){return{type:U,newMessage:e}}(e))}},deleteMessage:function(e){return function(s){s(function(e){return{type:H,id:e}}(e))}}})(Q),z=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,38)).then((function(s){var t=s.getCLS,a=s.getFID,n=s.getFCP,c=s.getLCP,r=s.getTTFB;t(e),a(e),n(e),c(e),r(e)}))},K=t(12),W=t(22),$=Object(K.b)({messages:V}),ee=Object(K.c)($,Object(K.a)(W.a));c.a.render(Object(d.jsx)(T.a,{store:ee,children:Object(d.jsx)(Z,{})}),document.getElementById("root")),z()},9:function(e,s,t){e.exports={header:"header_header__2JvcX",logo:"header_logo__22NU3",lastData:"header_lastData__24aOX"}}},[[37,1,2]]]);
//# sourceMappingURL=main.39ef076f.chunk.js.map